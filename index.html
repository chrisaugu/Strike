<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">

  <!-- Include Editor style. -->
  <!-- <link href="https://cdn.jsdelivr.net/npm/froala-editor@3.1.0/css/froala_editor.pkgd.min.css" rel="stylesheet" type="text/css" /> -->
  <!-- <link href="/css/froala_editor.pkgd.min.css" rel="stylesheet" type="text/css" /> -->
  <!-- <link rel="stylesheet" href="https://unpkg.com/dropzone@5/dist/min/dropzone.min.css" type="text/css" /> -->
  <link rel="stylesheet" href="/css/dropzone.min.css" type="text/css" />
  <style>
    form#myDropzone {
        width: 20%;
        height: 32%;
        padding: 80px;
        background: aliceblue;
        border: 0;
        border-radius: 28px;
    }
  </style>
</head>

<body>
  <div class="sample">
    <h2>Video upload example.</h2>
    <form id="myDropzone" class="dropzone" name="video" method="post" action="/upload" enctype="multipart/form-data">
      <!-- <textarea id="edit" name="content"></textarea> -->
      <!-- <input type="submit" value="Upload"/> -->
      <!-- <input type="file" name="file" id="myFiles" multiple="multiple"/> -->
    </form> 

    <div id="template-container"></div>
  </div>

  <!-- Include Editor JS files. -->
  <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/froala-editor@3.1.0/js/froala_editor.pkgd.min.js"></script> -->
  <!-- <script type="text/javascript" src="/js/froala_editor.pkgd.min.js"></script> -->
  <!-- <script src="https://unpkg.com/dropzone@5/dist/min/dropzone.min.js"></script> -->
  <script src="/js/dropzone.min.js"></script>

  <!-- Initialize the editor. -->
  <script>
    // new FroalaEditor('#edit', {

    //   // Set the video upload URL.
    //   videoUploadURL: '/video_upload',
    //   videoUploadParams: {
    //     id: 'my_editor'
    //   },

    //   // Set the file upload URL.
    //   imageUploadURL: 'image_upload',
    //   imageUploadParams: {
    //     id: 'my_editor'
    //   },

    //   // Set the file upload URL.
    //   fileUploadURL: 'file_upload',

    //   fileUploadParams: {
    //     id: 'my_editor'
    //   }
    // })
    Dropzone.autoDiscover = false;
    let myDropzone = new Dropzone("#myDropzone", { 
      url: "/upload",
      paramName: "file", // The name that will be used to transfer the file
      maxFilesize: 2, // MB
      // thumbnailWidth: 80,
      // thumbnailHeight: 80,
      // parallelUploads: 20,
      // previewTemplate: document.querySelector('#template-container').innerHTML,
      // autoQueue: false, // Make sure the files aren't queued until manually added
      // previewsContainer: "#previews", // Define the container to display the previews
      // clickable: ".fileinput-button", // Define the element that should be used as click trigger to select files.

      accept: function(file, done) {
        if (file.name == "justinbieber.jpg") {
          done("Naha, you don't.");
        }
        else { done(); }
      }
    });  
    //   init: function() {
    //     let myDropzone = this;

    //     // If you only have access to the original image sizes on your server,
    //     // and want to resize them in the browser:
    //     let mockFile = { name: "Filename 2", size: 12345 };
    //     myDropzone.displayExistingFile(mockFile, "https://i.picsum.photos/id/959/600/600.jpg");

    //     // If the thumbnail is already in the right size on your server:
    //     // let mockFile = { name: "Filename", size: 12345 };
    //     // let callback = null; // Optional callback when it's done
    //     // let crossOrigin = null; // Added to the `img` tag for crossOrigin handling
    //     // let resizeThumbnail = false; // Tells Dropzone whether it should resize the image first
    //     // myDropzone.displayExistingFile(mockFile, "https://i.picsum.photos/id/959/120/120.jpg", callback, crossOrigin, resizeThumbnail);

    //     // If you use the maxFiles option, make sure you adjust it to the
    //     // correct amount:
    //     let fileCountOnServer = 2; // The number of files already uploaded
    //     myDropzone.options.maxFiles = myDropzone.options.maxFiles - fileCountOnServer;
    //   }

    // const output = document.querySelector("#output");
    // myDropzone.on("addedfile", (file) => {
    //   // Add an info line about the added file for each file.
    //   // output.innerHTML += `<div>File added: ${file.name}</div>`;
    //   // file.previewElement = Dropzone.createElement(this.options.previewTemplate);
    //   console.log("hello: " + file.name);
    // });
    // myDropzone.on("complete", function(file) {
    //   myDropzone.removeFile(file);
    // });
    // myDropzone.on("thumbnail", function(file, dataUrl) {
    //   // Display the image in your file.previewElement
    // });
    // myDropzone.on("uploadprogress", function(file, progress, bytesSent) {
    //   // Display the progress
    // });
    
    // // Update the total progress bar
    // myDropzone.on("totaluploadprogress", function(progress) {
    //   document.querySelector("#total-progress .progress-bar").style.width = progress + "%";
    // });

    // myDropzone.on("sending", function(file) {
    //   // Show the total progress bar when upload starts
    //   document.querySelector("#total-progress").style.opacity = "1";
    //   // And disable the start button
    //   file.previewElement.querySelector(".start").setAttribute("disabled", "disabled");
    // });

    // // Hide the total progress bar when nothing's uploading anymore
    // myDropzone.on("queuecomplete", function(progress) {
    //   document.querySelector("#total-progress").style.opacity = "0";
    // });

    
    // let mockFile = { name: "Filename", size: 12345 };
    // myDropzone.displayExistingFile(mockFile, 'https://image-url');
  
    // const myForm = document.getElementById("myForm");
    // const myFile = document.getElementById("myFiles");

    // myForm.addEventListener("submit", function(e) {
    //   e.preventDefault();

    //   var endpoint = "/video_upload";
    //   var formdata = new FormData();

    //   formdata.append("files", myFile.files[0]);

    //   fetch(endpoint, {
    //     method: "POST",
    //     body: formdata
    //   })
    //   .catch(function(err) {
    //     console.log(err);
    //   });

    // });
  </script>
</body>
</html>